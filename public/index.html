<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Subtext ‚Äî –í—Ö–æ–¥</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root {
  --lamp-on: 0;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  min-height: 100vh;
  font-family: 'Poppins', sans-serif;
  background: radial-gradient(circle at top, #1c1f1c, #0f120f);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  transition: background 0.6s ease;
}

body[data-on="true"] {
  background:
    radial-gradient(circle at top, #e8f5e9, #c8e6c9),
    linear-gradient(135deg, #e0f2f1, #f1f8e9);
}

/* ===== –õ–ê–ú–ü–ê ===== */
.lamp-wrap {
  position: absolute;
  top: 40px;
  text-align: center;
  cursor: pointer;
}

.lamp {
  font-size: 5rem;
  transition: .4s ease;
  filter: drop-shadow(0 0 calc(40px * var(--lamp-on)) rgba(255,255,180,.8));
}

.switch {
  margin-top: .4rem;
  font-size: .85rem;
  opacity: .7;
}

.lamp-wrap:hover .lamp {
  transform: scale(1.08);
}

/* ===== CARD ===== */
.card {
  opacity: 0;
  transform: translateY(20px);
  pointer-events: none;
  transition: .6s ease;
  width: 100%;
  max-width: 420px;
  background: rgba(255,255,255,0.65);
  backdrop-filter: blur(18px);
  border-radius: 26px;
  padding: 3rem 2.5rem;
  box-shadow:
    0 20px 60px rgba(0,0,0,.15),
    inset 0 0 0 1px rgba(255,255,255,.4);
  text-align: center;
  color: #1b3a1b;
}

body[data-on="true"] .card {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

/* ===== TEXT ===== */
.logo {
  font-family: 'Playfair Display', serif;
  font-size: 3.8rem;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: rgba(255,255,255,0.9);
  text-shadow:
    2px 2px 0 rgba(0,60,0,.7),
    0 10px 25px rgba(0,0,0,.25);
  margin-bottom: .4rem;
}

.subtitle {
  font-size: .95rem;
  opacity: .85;
  margin-bottom: 2.5rem;
}

input {
  width: 100%;
  padding: 1rem 1.2rem;
  border-radius: 999px;
  border: none;
  font-size: 1rem;
  outline: none;
  text-align: center;
  margin-bottom: 1.2rem;
}

button {
  width: 100%;
  padding: 1rem;
  border-radius: 999px;
  border: none;
  font-weight: 600;
  color: #fff;
  cursor: pointer;
  background: linear-gradient(135deg, #1b5e20, #66bb6a);
}

.error {
  margin-top: 1rem;
  font-size: .85rem;
  color: #b71c1c;
  min-height: 1.2em;
}

.hint {
  margin-top: 1.6rem;
  font-size: .75rem;
  opacity: .7;
}
</style>
</head>

<body data-on="false">

<!-- –õ–ê–ú–ü–ê -->
<div class="lamp-wrap" onclick="toggleLamp()">
  <div class="lamp">üí°</div>
  <div class="switch">–≤–∫–ª—é—á–∏—Ç—å —Å–≤–µ—Ç</div>
</div>

<!-- CARD -->
<div class="card">
  <div class="logo">Subtext</div>
  <div class="subtitle">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —É—á–µ–Ω–∏–∫–∞</div>

  <input type="text" id="idInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à ID">
  <button onclick="enterById()">–í–æ–π—Ç–∏</button>

  <div id="errorMsg" class="error"></div>
  <div class="hint">ID –≤—ã–¥–∞—ë—Ç—Å—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º</div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycby59Nl9tWHaJIV_S9AySxKTAWSJ0kgvNk-WtCtrYMX8FLGyLFkxTQApzCrwVnNQRM51dg/exec";

let isOn = false;
const root = document.documentElement;
const body = document.body;

function toggleLamp() {
  isOn = !isOn;
  body.setAttribute("data-on", isOn);
  root.style.setProperty("--lamp-on", isOn ? 1 : 0);
}

async function enterById() {
  const id = idInput.value.trim();
  errorMsg.textContent = "";

  if (!id) {
    errorMsg.textContent = "–í–≤–µ–¥–∏—Ç–µ ID";
    return;
  }

  try {
    const res = await fetch(`${API_URL}?action=check_user&userId=${encodeURIComponent(id)}`);
    const data = await res.json();

    if (data.success) {
      window.location.href = `lk.html?id=${encodeURIComponent(id)}`;
    } else {
      errorMsg.textContent = "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω";
    }
  } catch {
    errorMsg.textContent = "–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è";
  }
}
</script>

</body>
</html>
